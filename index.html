<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family: Arial, sans-serif;
  padding:20px;
  min-height:100vh;
  background: linear-gradient(135deg,#0f0f10,#1a1a1d,#232326,#111113);
  background-size:300% 300%;
  animation:bgMove 16s ease infinite;
}
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}

.invoice{
  max-width:1000px;
  margin:auto;
  background:rgba(25,25,28,.95);
  padding:26px;
  border-radius:18px;
  box-shadow:0 20px 55px rgba(0,0,0,.6);
  color:#e5e7eb;
}

h2{
  margin:0 0 14px;
  font-size:30px;
  color:#f8fafc;
}

.row{display:flex;gap:15px;flex-wrap:wrap}
.col{flex:1;min-width:220px}
label{font-size:12px;font-weight:bold;color:#cbd5e1}

input,textarea,select{
  width:100%;
  padding:9px;
  border-radius:8px;
  border:1px solid #333;
  background:#121214;
  color:#f8fafc;
}

table{width:100%;border-collapse:collapse;margin-top:18px}
th,td{border:1px solid #303036;padding:9px;text-align:center}
th{background:#1f1f23}

.btn{
  padding:10px 22px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.15);
  background:linear-gradient(135deg,#2a2a2d,#1c1c1f);
  color:#f8fafc;
  font-weight:bold;
  cursor:pointer;
  transition:.25s;
}
.btn:hover{transform:translateY(-2px)}

.btn.gray{background:#111}

.remove-btn{
  background:#111;
  color:#f87171;
  border:none;
  font-size:18px;
  cursor:pointer;
}

.total-box{max-width:420px;margin-left:auto;margin-top:18px}
.total-box div{display:flex;justify-content:space-between;padding:6px 0}
.grand{font-size:18px;font-weight:bold;border-top:1px solid #3f3f46;padding-top:8px}
.error{color:#f87171;font-size:12px}

/* ✅ PRINT FIX + HEADER REPEAT + PAGE CONTROL */
@media print{

  @page{
    size:A4;
    margin:10mm;
  }

  body{
    background:#fff;
    margin:0;
  }

  .invoice{
    color:#000;
    box-shadow:none;
    border-radius:0;
    page-break-inside:auto;
  }

  h2{color:#008080}

  label, th{
    color:#008080 !important;
  }

  td, input, textarea, select, span, small{
    color:#000 !important;
  }

  .grand{color:#008080 !important}

  table{
    page-break-inside:auto;
  }

  tr{
    page-break-inside:avoid;
    page-break-after:auto;
  }

  thead{
    display:table-header-group; /* repeat header on next page */
  }

  tfoot{
    display:table-footer-group;
  }

  .btn,.no-print{display:none !important}

  input,textarea,select{
    border:none;
    background:none;
  }
}
</style>
</head>

<body>

<div class="invoice">
<h2>TAQWA TECHNOLOGIES Pvt Ltd</h2>

<div class="row">
  <div class="col">
    <label>Company Name (Product)</label>
    <input value="INFINITY">
  </div>
  <div class="col">
    <label>Company GSTIN</label>
    <input id="cgstin" value="37AALCT9788L1Z3" oninput="validateGST(this)">
    <div id="gstErr" class="error"></div>
  </div>
  <div class="col">
    <label>Company State</label>
    <input value="AndhraPradesh">
  </div>
</div>

<br>

<div class="row">
  <div class="col">
    <label>Bill To</label>
    <input value=" Commission From Restaurant">
  </div>
  <div class="col">
    <label>Place of Supply</label>
    <input id="supply">
  </div>
  <div class="col">
    <label>Invoice No</label>
    <input id="inv" readonly>
    <label>Date</label>
    <input type="date" id="date">
  </div>
</div>

<table id="tbl">
<thead>
<tr>
<th>Item</th><th>Qty</th><th>Rate</th><th>Amount</th><th class="no-print"></th>
</tr>
</thead>
<tbody></tbody>
</table>

<br>
<button class="btn" onclick="addRow()">+ Add Item</button>

<div class="row" style="margin-top:16px">
  <div class="col">
    <label>GST %</label>
    <select id="gst" onchange="calc()">
      <option>0</option><option>5</option><option>12</option>
      <option selected>18</option><option>28</option>
    </select>
  </div>
</div>

<div class="total-box">
  <div><span>Subtotal</span><span id="sub">₹0</span></div>
  <div id="taxLines"></div>
  <div class="grand"><span>Grand Total</span><span id="grand">₹0</span></div>
  <small><b>In Words:</b> <span id="words"></span></small>
</div>

<br>
<button class="btn gray" onclick="window.print()">Print / Save PDF</button>
</div>

<script>
date.value=new Date().toISOString().slice(0,10)

let n=localStorage.getItem("invoiceNo")||0
n++;localStorage.setItem("invoiceNo",n)
inv.value="INV-"+String(n).padStart(4,"0")

function addRow(){
  let tr=document.createElement("tr")
  tr.innerHTML=`
    <td><input></td>
    <td><input type="number" value="1" oninput="calc()"></td>
    <td><input type="number" value="0" oninput="calc()"></td>
    <td class="amt">0</td>
    <td class="no-print">
      <button class="remove-btn" onclick="this.closest('tr').remove();calc()">✖</button>
    </td>`
  tbl.querySelector("tbody").appendChild(tr)
}
addRow()

function calc(){
  let sub=0
  document.querySelectorAll("#tbl tbody tr").forEach(r=>{
    let q=+r.children[1].querySelector("input").value
    let p=+r.children[2].querySelector("input").value
    let a=q*p
    r.querySelector(".amt").innerText=a.toFixed(2)
    sub+=a
  })
  let gstv=+gst.value
  let tax=sub*gstv/100
  taxLines.innerHTML=gstv?`<div><span>GST ${gstv}%</span><span>₹${tax.toFixed(2)}</span></div>`:""
  sub.innerText="₹"+sub.toFixed(2)
  grand.innerText="₹"+Math.round(sub+tax)
  words.innerText=toWords(Math.round(sub+tax))
}

function validateGST(el){
  let r=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z][1-9A-Z]Z[0-9A-Z]$/
  gstErr.innerText=r.test(el.value)?"":"Invalid GSTIN"
}

function toWords(n){
  let a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
         "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"]
  let b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"]
  if(n<20)return a[n]+" only"
  if(n<100)return b[Math.floor(n/10)]+" "+a[n%10]+" only"
  if(n<1000)return a[Math.floor(n/100)]+" Hundred "+toWords(n%100)
  return toWords(Math.floor(n/1000))+" Thousand "+toWords(n%1000)
}
</script>

</body>
</html>
